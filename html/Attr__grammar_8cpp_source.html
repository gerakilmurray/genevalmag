<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>maggen: src/Attr_grammar/Attr_grammar.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<h1>src/Attr_grammar/Attr_grammar.cpp</h1><a href="Attr__grammar_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00009"></a>00009 <span class="preprocessor">#include &lt;boost/tokenizer.hpp&gt;</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00011"></a>00011 
<a name="l00012"></a>00012 <span class="preprocessor">#include &quot;../../include/Attr_grammar/Attr_grammar.h&quot;</span>
<a name="l00013"></a>00013 
<a name="l00014"></a>00014 <span class="keyword">using namespace </span>std;
<a name="l00015"></a>00015 
<a name="l00016"></a>00016 <span class="keyword">namespace </span>genevalmag
<a name="l00017"></a>00017 {
<a name="l00018"></a>00018 
<a name="l00022"></a><a class="code" href="classgenevalmag_1_1Attr__grammar.html#a4163922d72d60143cd36008ab7f7abce">00022</a> <a class="code" href="classgenevalmag_1_1Attr__grammar.html#a4163922d72d60143cd36008ab7f7abce">Attr_grammar::Attr_grammar</a>()
<a name="l00023"></a>00023 {
<a name="l00025"></a>00025     <a class="code" href="classgenevalmag_1_1Attr__grammar.html#abdcc6aa17756d47b0e6e131b26050b42" title="Saves the name of the initial symbol of the grammar&amp;#39;s attribute.">ag_initial_symb</a> = NULL;
<a name="l00026"></a>00026     <a class="code" href="classgenevalmag_1_1Attr__grammar.html#a127f4869156cd76ee3381b19d8c7cc9a" title="Store the count of equations in the gramamar.">count_eqs</a>       = 0;
<a name="l00027"></a>00027 }
<a name="l00028"></a>00028 
<a name="l00032"></a><a class="code" href="classgenevalmag_1_1Attr__grammar.html#a4655bdc8253f4d480fd68441363a3cd0">00032</a> <a class="code" href="classgenevalmag_1_1Attr__grammar.html#a4655bdc8253f4d480fd68441363a3cd0">Attr_grammar::~Attr_grammar</a>()
<a name="l00033"></a>00033 {
<a name="l00034"></a>00034 }
<a name="l00035"></a>00035 
<a name="l00042"></a><a class="code" href="namespacegenevalmag.html#a95d75ecfcb4371b57086093c66a96bd4">00042</a> <span class="keyword">template</span> &lt;<span class="keyword">class</span> K, <span class="keyword">class</span> T&gt; <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="namespacegenevalmag.html#a95d75ecfcb4371b57086093c66a96bd4">add</a>(<span class="keyword">const</span> T &amp;elem, map&lt; K ,T &gt; &amp;map_elem)
<a name="l00043"></a>00043 {
<a name="l00044"></a>00044     pair&lt; K, T &gt; new_p(elem.key(), elem);
<a name="l00045"></a>00045     pair&lt;typename map&lt; K, T  &gt;::const_iterator, <span class="keywordtype">bool</span> &gt; result(map_elem.insert(new_p));
<a name="l00046"></a>00046     <span class="keywordflow">return</span> result.second;
<a name="l00047"></a>00047 }
<a name="l00048"></a>00048 
<a name="l00054"></a><a class="code" href="namespacegenevalmag.html#abdfa348edf2ec215b8dce63ebeab02e9">00054</a> <span class="keyword">template</span> &lt;<span class="keyword">class</span> K, <span class="keyword">class</span> T&gt; <span class="keyword">const</span> <span class="keywordtype">string</span> <a class="code" href="namespacegenevalmag.html#abdfa348edf2ec215b8dce63ebeab02e9">to_string_map</a>(<span class="keyword">const</span> map&lt; K ,T &gt; &amp;map_elem)
<a name="l00055"></a>00055 {
<a name="l00056"></a>00056     <span class="keywordtype">string</span> elem;
<a name="l00057"></a>00057     <span class="keywordflow">for</span>(<span class="keyword">typename</span> map&lt; K, T &gt;::const_iterator it(map_elem.begin()); it != map_elem.end(); it++)
<a name="l00058"></a>00058     {
<a name="l00059"></a>00059         elem.append(<span class="stringliteral">&quot;    &quot;</span>);
<a name="l00060"></a>00060         elem.append(it-&gt;second.to_string());
<a name="l00061"></a>00061         elem.append(<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00062"></a>00062     }
<a name="l00063"></a>00063     <span class="keywordflow">return</span> elem;
<a name="l00064"></a>00064 }
<a name="l00065"></a>00065 
<a name="l00069"></a><a class="code" href="classgenevalmag_1_1Attr__grammar.html#aaa4b67f68b6cdcf70ed5876b63343db7">00069</a> <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="classgenevalmag_1_1Attr__grammar.html#aaa4b67f68b6cdcf70ed5876b63343db7">Attr_grammar::add_sort</a>(<span class="keyword">const</span> <a class="code" href="classgenevalmag_1_1Sort.html">Sort</a> &amp;sort)
<a name="l00070"></a>00070 {
<a name="l00071"></a>00071     <span class="keywordflow">return</span> add&lt;string, Sort&gt;(sort, <a class="code" href="classgenevalmag_1_1Attr__grammar.html#a799dddeffb394e06770b8143b46cbc87">ag_sort</a>);
<a name="l00072"></a>00072 }
<a name="l00073"></a>00073 
<a name="l00077"></a><a class="code" href="classgenevalmag_1_1Attr__grammar.html#a2dc3357532cdef0dd92eaf3f55ca2ec2">00077</a> <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="classgenevalmag_1_1Attr__grammar.html#a2dc3357532cdef0dd92eaf3f55ca2ec2">Attr_grammar::add_function</a>(<span class="keyword">const</span> <a class="code" href="classgenevalmag_1_1Function.html">Function</a> &amp;func)
<a name="l00078"></a>00078 {
<a name="l00079"></a>00079     <span class="keywordflow">return</span> add&lt;string, Function&gt;(func, <a class="code" href="classgenevalmag_1_1Attr__grammar.html#a3ebc66b5f02a2c6806a6002dd09fc34f">ag_func</a>);
<a name="l00080"></a>00080 }
<a name="l00081"></a>00081 
<a name="l00085"></a><a class="code" href="classgenevalmag_1_1Attr__grammar.html#a4ccf3523a20ea3e646942af93a9df7e2">00085</a> <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="classgenevalmag_1_1Attr__grammar.html#a4ccf3523a20ea3e646942af93a9df7e2">Attr_grammar::add_attribute</a>(<span class="keyword">const</span> <a class="code" href="classgenevalmag_1_1Attribute.html">Attribute</a> &amp;attr)
<a name="l00086"></a>00086 {
<a name="l00087"></a>00087     <span class="keywordflow">return</span> add&lt;string, Attribute&gt;(attr, <a class="code" href="classgenevalmag_1_1Attr__grammar.html#af8eda41983da416b71568b230495cac3">ag_attr</a>);
<a name="l00088"></a>00088 }
<a name="l00089"></a>00089 
<a name="l00094"></a><a class="code" href="namespacegenevalmag.html#a9cb36d1a43794afa2b45c729c6c87170">00094</a> <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="namespacegenevalmag.html#a9cb36d1a43794afa2b45c729c6c87170">belong</a>(<span class="keyword">const</span> <a class="code" href="classgenevalmag_1_1Symbol.html">Symbol</a> &amp;symb, <span class="keyword">const</span> <span class="keywordtype">string</span> &amp;expr_attrs)
<a name="l00095"></a>00095 {
<a name="l00096"></a>00096     <span class="keyword">typedef</span> boost::tokenizer&lt;boost::char_separator&lt;char&gt; &gt; tokenizer;
<a name="l00097"></a>00097     boost::char_separator&lt;char&gt; sep(<span class="stringliteral">&quot;{},-&quot;</span>);
<a name="l00098"></a>00098     tokenizer tokens(expr_attrs, sep);
<a name="l00099"></a>00099     tokenizer::iterator tok_iter(tokens.begin());
<a name="l00100"></a>00100 
<a name="l00101"></a>00101     <span class="keywordflow">if</span>((*tok_iter).compare(<span class="stringliteral">&quot;all&quot;</span>) == 0)
<a name="l00102"></a>00102     {
<a name="l00103"></a>00103         <span class="keywordflow">for</span>(tok_iter++; tok_iter != tokens.end(); tok_iter++)
<a name="l00104"></a>00104         {
<a name="l00105"></a>00105             <span class="keywordflow">if</span>(symb.<a class="code" href="classgenevalmag_1_1Symbol.html#afcd9c46fe546ec9f1b62caeb99377917">get_name</a>().compare(*tok_iter) == 0)
<a name="l00106"></a>00106             {
<a name="l00107"></a>00107                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00108"></a>00108             }
<a name="l00109"></a>00109         }
<a name="l00110"></a>00110         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00111"></a>00111     }
<a name="l00112"></a>00112     <span class="keywordflow">else</span>
<a name="l00113"></a>00113     {
<a name="l00114"></a>00114         <span class="keywordflow">for</span>(; tok_iter != tokens.end(); tok_iter++)
<a name="l00115"></a>00115         {
<a name="l00116"></a>00116             <span class="keywordflow">if</span>(symb.<a class="code" href="classgenevalmag_1_1Symbol.html#afcd9c46fe546ec9f1b62caeb99377917">get_name</a>().compare(*tok_iter) == 0)
<a name="l00117"></a>00117             {
<a name="l00118"></a>00118                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00119"></a>00119             }
<a name="l00120"></a>00120         }
<a name="l00121"></a>00121         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00122"></a>00122     }
<a name="l00123"></a>00123 }
<a name="l00124"></a>00124 
<a name="l00128"></a><a class="code" href="classgenevalmag_1_1Attr__grammar.html#afaa4c9d59c02bb170691cad72bf97c68">00128</a> <span class="keywordtype">void</span> <a class="code" href="classgenevalmag_1_1Attr__grammar.html#afaa4c9d59c02bb170691cad72bf97c68">Attr_grammar::load_attributes</a>(<a class="code" href="classgenevalmag_1_1Symbol.html">Symbol</a> &amp;symb)<span class="keyword"> const</span>
<a name="l00129"></a>00129 <span class="keyword"></span>{
<a name="l00130"></a>00130     <span class="keywordflow">for</span>(map&lt;string,Attribute&gt;::const_iterator it(<a class="code" href="classgenevalmag_1_1Attr__grammar.html#af8eda41983da416b71568b230495cac3">ag_attr</a>.begin()); it != <a class="code" href="classgenevalmag_1_1Attr__grammar.html#af8eda41983da416b71568b230495cac3">ag_attr</a>.end(); it++)
<a name="l00131"></a>00131     {
<a name="l00132"></a>00132         <span class="keywordflow">if</span>(<a class="code" href="namespacegenevalmag.html#a9cb36d1a43794afa2b45c729c6c87170">belong</a>(symb, it-&gt;second.get_member_symbol()))
<a name="l00133"></a>00133         {
<a name="l00134"></a>00134             symb.<a class="code" href="classgenevalmag_1_1Symbol.html#a41ceb415014d2cfbb5976c3fd2bbf35f">add_attr</a>(&amp;(it-&gt;second));
<a name="l00135"></a>00135         }
<a name="l00136"></a>00136     }
<a name="l00137"></a>00137 }
<a name="l00138"></a>00138 
<a name="l00142"></a><a class="code" href="classgenevalmag_1_1Attr__grammar.html#a66644b6cede73b6dcbdc7b6b7ef8826d">00142</a> <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="classgenevalmag_1_1Attr__grammar.html#a66644b6cede73b6dcbdc7b6b7ef8826d">Attr_grammar::add_symbol</a>(<span class="keyword">const</span> <a class="code" href="classgenevalmag_1_1Symbol.html">Symbol</a> &amp;symb)
<a name="l00143"></a>00143 {
<a name="l00144"></a>00144     map&lt;string, Symbol&gt; *map_symb;
<a name="l00145"></a>00145     <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> id_symbol(1);
<a name="l00146"></a>00146     <span class="keywordflow">if</span> (symb.<a class="code" href="classgenevalmag_1_1Symbol.html#ad44a494066886a7b83d4052367e8903b">is_non_terminal</a>())
<a name="l00147"></a>00147     {
<a name="l00148"></a>00148         map_symb = &amp;<a class="code" href="classgenevalmag_1_1Attr__grammar.html#a82631f05839109d0569a1554a35fa906">ag_symb_non_terminals</a>;
<a name="l00149"></a>00149     }
<a name="l00150"></a>00150     <span class="keywordflow">else</span>
<a name="l00151"></a>00151     {
<a name="l00152"></a>00152         map_symb = &amp;<a class="code" href="classgenevalmag_1_1Attr__grammar.html#aae56008f83f809143d7f157a7281831d">ag_symb_terminals</a>;
<a name="l00153"></a>00153     }
<a name="l00154"></a>00154     <span class="keywordtype">bool</span> not_repeat = add &lt;string, Symbol&gt;(symb, *map_symb);
<a name="l00155"></a>00155     <span class="keywordflow">if</span>(not_repeat &amp;&amp; symb.is_non_terminal())
<a name="l00156"></a>00156     {
<a name="l00157"></a>00157         map&lt;string, Symbol&gt;::iterator it(map_symb-&gt;find(symb.key()));
<a name="l00158"></a>00158         <a class="code" href="classgenevalmag_1_1Attr__grammar.html#afaa4c9d59c02bb170691cad72bf97c68">load_attributes</a>(it-&gt;second);
<a name="l00159"></a>00159         it-&gt;second.set_id(id_symbol++);
<a name="l00160"></a>00160     }
<a name="l00161"></a>00161 
<a name="l00162"></a>00162     <span class="keywordflow">return</span> not_repeat;
<a name="l00163"></a>00163 }
<a name="l00164"></a>00164 
<a name="l00168"></a><a class="code" href="classgenevalmag_1_1Attr__grammar.html#a3d7a28dbbd12cbfc7a0bb41a7f8b8ab7">00168</a> <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="classgenevalmag_1_1Attr__grammar.html#a3d7a28dbbd12cbfc7a0bb41a7f8b8ab7">Attr_grammar::defined_rule</a>(<span class="keyword">const</span> <a class="code" href="classgenevalmag_1_1Rule.html">Rule</a> &amp;rule)<span class="keyword"> const</span>
<a name="l00169"></a>00169 <span class="keyword"></span>{
<a name="l00170"></a>00170     <span class="keywordflow">for</span>(map&lt;unsigned short, Rule&gt;::const_iterator it(<a class="code" href="classgenevalmag_1_1Attr__grammar.html#a962f40d15bf80b0e10b27126bd149a93">ag_rule</a>.begin()); it != <a class="code" href="classgenevalmag_1_1Attr__grammar.html#a962f40d15bf80b0e10b27126bd149a93">ag_rule</a>.end(); it++)
<a name="l00171"></a>00171     {
<a name="l00172"></a>00172         <span class="keywordflow">if</span> (it-&gt;second.equals(rule))
<a name="l00173"></a>00173         {
<a name="l00174"></a>00174             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00175"></a>00175         }
<a name="l00176"></a>00176     }
<a name="l00177"></a>00177     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00178"></a>00178 }
<a name="l00179"></a>00179 
<a name="l00183"></a><a class="code" href="classgenevalmag_1_1Attr__grammar.html#aec81306d22cc26b9d7276b70d30d329b">00183</a> <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="classgenevalmag_1_1Attr__grammar.html#aec81306d22cc26b9d7276b70d30d329b">Attr_grammar::add_rule</a>(<a class="code" href="classgenevalmag_1_1Rule.html">Rule</a> &amp;rule)
<a name="l00184"></a>00184 {
<a name="l00185"></a>00185     <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> id_rules(1);
<a name="l00186"></a>00186 
<a name="l00187"></a>00187     <span class="keywordflow">if</span> (<a class="code" href="classgenevalmag_1_1Attr__grammar.html#a3d7a28dbbd12cbfc7a0bb41a7f8b8ab7">defined_rule</a>(rule))
<a name="l00188"></a>00188     {
<a name="l00189"></a>00189         <span class="comment">/* The rule is already defined then it isn&#39;t inserted. */</span>
<a name="l00190"></a>00190         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00191"></a>00191     }
<a name="l00192"></a>00192     rule.<a class="code" href="classgenevalmag_1_1Rule.html#af1f423dd609fc03692dd44a9b421d0eb">set_id</a>(id_rules++);
<a name="l00193"></a>00193 
<a name="l00194"></a>00194     <span class="keywordflow">if</span> (<a class="code" href="classgenevalmag_1_1Attr__grammar.html#abdcc6aa17756d47b0e6e131b26050b42" title="Saves the name of the initial symbol of the grammar&amp;#39;s attribute.">ag_initial_symb</a> != NULL &amp;&amp; rule.<a class="code" href="classgenevalmag_1_1Rule.html#a587e49507f553c99c79c82aabe6c470f">belongs_non_terminal</a>(*<a class="code" href="classgenevalmag_1_1Attr__grammar.html#abdcc6aa17756d47b0e6e131b26050b42" title="Saves the name of the initial symbol of the grammar&amp;#39;s attribute.">ag_initial_symb</a>))
<a name="l00195"></a>00195     <span class="comment">/* Check if the rule respet the extended grammar. */</span>
<a name="l00196"></a>00196     {
<a name="l00197"></a>00197         cerr &lt;&lt; <span class="stringliteral">&quot;ERROR: The grammar isn&#39;t extended grammar.&quot;</span> &lt;&lt; endl;
<a name="l00198"></a>00198         exit(-1);
<a name="l00199"></a>00199     }
<a name="l00200"></a>00200     <span class="keywordtype">bool</span> result(add &lt;unsigned short, Rule&gt;(rule, <a class="code" href="classgenevalmag_1_1Attr__grammar.html#a962f40d15bf80b0e10b27126bd149a93">ag_rule</a>));
<a name="l00201"></a>00201     <span class="keywordflow">if</span> (result)
<a name="l00202"></a>00202     {
<a name="l00203"></a>00203         <span class="keywordflow">if</span>(<a class="code" href="classgenevalmag_1_1Attr__grammar.html#abdcc6aa17756d47b0e6e131b26050b42" title="Saves the name of the initial symbol of the grammar&amp;#39;s attribute.">ag_initial_symb</a> == NULL)
<a name="l00204"></a>00204         {
<a name="l00205"></a>00205             <span class="comment">/* Set initial symbol of grammar. */</span>
<a name="l00206"></a>00206 <span class="comment">//            map&lt;unsigned short, Rule&gt;::const_iterator init_rule(ag_rule.find(rule.key()));</span>
<a name="l00207"></a>00207 <span class="comment">//            ag_initial_symb = init_rule-&gt;second.get_left_symbol();</span>
<a name="l00208"></a>00208                 <a class="code" href="classgenevalmag_1_1Attr__grammar.html#abdcc6aa17756d47b0e6e131b26050b42" title="Saves the name of the initial symbol of the grammar&amp;#39;s attribute.">ag_initial_symb</a> = rule.<a class="code" href="classgenevalmag_1_1Rule.html#a4d67205ef292350a440a10f7bbdda0e1">get_left_symbol</a>();
<a name="l00209"></a>00209         }
<a name="l00210"></a>00210         <span class="keywordflow">if</span>(rule.<a class="code" href="classgenevalmag_1_1Rule.html#aa91f94ae6289b840dc17414c59a844a4">get_eqs</a>().size() &gt; 0)
<a name="l00211"></a>00211         {
<a name="l00212"></a>00212                         map&lt;unsigned short,Rule&gt;::const_iterator last_rule(<a class="code" href="classgenevalmag_1_1Attr__grammar.html#a962f40d15bf80b0e10b27126bd149a93">ag_rule</a>.end());
<a name="l00213"></a>00213                         last_rule--;
<a name="l00214"></a>00214                         map&lt;unsigned short,Equation&gt;::const_iterator last_eq(last_rule-&gt;second.get_eqs().end());
<a name="l00215"></a>00215                         last_eq--;
<a name="l00216"></a>00216                         <a class="code" href="classgenevalmag_1_1Attr__grammar.html#a127f4869156cd76ee3381b19d8c7cc9a" title="Store the count of equations in the gramamar.">count_eqs</a> = last_eq-&gt;second.get_id();
<a name="l00217"></a>00217         }
<a name="l00218"></a>00218     }
<a name="l00219"></a>00219     <span class="keywordflow">return</span> result;
<a name="l00220"></a>00220 }
<a name="l00221"></a>00221 
<a name="l00225"></a><a class="code" href="classgenevalmag_1_1Attr__grammar.html#acfa0b0a6876e33a4f6ab19afd073edf8">00225</a> <span class="keyword">const</span> <a class="code" href="classgenevalmag_1_1Sort.html">Sort</a> &amp;<a class="code" href="classgenevalmag_1_1Attr__grammar.html#acfa0b0a6876e33a4f6ab19afd073edf8">Attr_grammar::return_sort</a>(<span class="keyword">const</span> <span class="keywordtype">string</span> name_sort)
<a name="l00226"></a>00226 {
<a name="l00227"></a>00227     <a class="code" href="classgenevalmag_1_1Sort.html">Sort</a> sort_new(name_sort);
<a name="l00228"></a>00228     <span class="comment">/* It must be a basic type. Since it became an explicit add_sort above. */</span>
<a name="l00229"></a>00229     sort_new.<a class="code" href="classgenevalmag_1_1Sort.html#aef4090cc2961e5f9614d1db43386d485">set_type_basic</a>(<span class="keyword">true</span>);
<a name="l00230"></a>00230     <a class="code" href="classgenevalmag_1_1Attr__grammar.html#aaa4b67f68b6cdcf70ed5876b63343db7">add_sort</a>(sort_new);
<a name="l00231"></a>00231     map&lt;string,Sort&gt;::const_iterator it(<a class="code" href="classgenevalmag_1_1Attr__grammar.html#a799dddeffb394e06770b8143b46cbc87">ag_sort</a>.find(name_sort));
<a name="l00232"></a>00232     <span class="keywordflow">return</span> it-&gt;second;
<a name="l00233"></a>00233 }
<a name="l00234"></a>00234 
<a name="l00238"></a><a class="code" href="classgenevalmag_1_1Attr__grammar.html#a9e56cac2670355a2d93e3cd20afc1c2d">00238</a> <span class="keyword">const</span> map&lt;string, Sort&gt; &amp;<a class="code" href="classgenevalmag_1_1Attr__grammar.html#a9e56cac2670355a2d93e3cd20afc1c2d">Attr_grammar::get_sorts</a>()<span class="keyword"> const</span>
<a name="l00239"></a>00239 <span class="keyword"></span>{
<a name="l00240"></a>00240     <span class="keywordflow">return</span> <a class="code" href="classgenevalmag_1_1Attr__grammar.html#a799dddeffb394e06770b8143b46cbc87">ag_sort</a>;
<a name="l00241"></a>00241 }
<a name="l00242"></a>00242 
<a name="l00246"></a><a class="code" href="classgenevalmag_1_1Attr__grammar.html#ae1070b6d532da48fb2d87c40c76cf341">00246</a> <span class="keyword">const</span> <a class="code" href="classgenevalmag_1_1Function.html">Function</a> *<a class="code" href="classgenevalmag_1_1Attr__grammar.html#ae1070b6d532da48fb2d87c40c76cf341">Attr_grammar::get_function</a>(<span class="keyword">const</span> <span class="keywordtype">string</span> key_function)<span class="keyword"> const</span>
<a name="l00247"></a>00247 <span class="keyword"></span>{
<a name="l00248"></a>00248     map&lt;string,Function&gt;::const_iterator it(<a class="code" href="classgenevalmag_1_1Attr__grammar.html#a3ebc66b5f02a2c6806a6002dd09fc34f">ag_func</a>.find(key_function));
<a name="l00249"></a>00249     <span class="keywordflow">if</span> (it == <a class="code" href="classgenevalmag_1_1Attr__grammar.html#a3ebc66b5f02a2c6806a6002dd09fc34f">ag_func</a>.end())
<a name="l00250"></a>00250     {
<a name="l00251"></a>00251         <span class="keywordflow">return</span> NULL;
<a name="l00252"></a>00252     }
<a name="l00253"></a>00253     <span class="keywordflow">return</span> &amp;(it-&gt;second);
<a name="l00254"></a>00254 }
<a name="l00255"></a>00255 
<a name="l00259"></a><a class="code" href="classgenevalmag_1_1Attr__grammar.html#ae9743e35703d55c1d9594d7061340b9b">00259</a> <span class="keyword">const</span> map&lt;string, Function&gt; &amp;<a class="code" href="classgenevalmag_1_1Attr__grammar.html#ae9743e35703d55c1d9594d7061340b9b">Attr_grammar::get_functions</a>()<span class="keyword"> const</span>
<a name="l00260"></a>00260 <span class="keyword"></span>{
<a name="l00261"></a>00261     <span class="keywordflow">return</span> <a class="code" href="classgenevalmag_1_1Attr__grammar.html#a3ebc66b5f02a2c6806a6002dd09fc34f">ag_func</a>;
<a name="l00262"></a>00262 }
<a name="l00263"></a>00263 
<a name="l00267"></a><a class="code" href="classgenevalmag_1_1Attr__grammar.html#a09a1044b5f34ae5794d602716b743129">00267</a> <span class="keyword">const</span> <a class="code" href="classgenevalmag_1_1Symbol.html">Symbol</a> &amp;<a class="code" href="classgenevalmag_1_1Attr__grammar.html#a09a1044b5f34ae5794d602716b743129">Attr_grammar::get_symbol</a>(<span class="keyword">const</span> <span class="keywordtype">string</span> name_symbol)<span class="keyword"> const</span>
<a name="l00268"></a>00268 <span class="keyword"></span>{
<a name="l00269"></a>00269     map&lt;string,Symbol&gt;::const_iterator it(<a class="code" href="classgenevalmag_1_1Attr__grammar.html#a82631f05839109d0569a1554a35fa906">ag_symb_non_terminals</a>.find(name_symbol));
<a name="l00270"></a>00270     <span class="keywordflow">if</span> (it == <a class="code" href="classgenevalmag_1_1Attr__grammar.html#a82631f05839109d0569a1554a35fa906">ag_symb_non_terminals</a>.end())
<a name="l00271"></a>00271     {
<a name="l00272"></a>00272         it = <a class="code" href="classgenevalmag_1_1Attr__grammar.html#aae56008f83f809143d7f157a7281831d">ag_symb_terminals</a>.find(name_symbol);
<a name="l00273"></a>00273     }
<a name="l00274"></a>00274     <span class="keywordflow">return</span> it-&gt;second;
<a name="l00275"></a>00275 }
<a name="l00276"></a>00276 
<a name="l00280"></a><a class="code" href="classgenevalmag_1_1Attr__grammar.html#a41be9d108df7f8159bd989a5c174be87">00280</a> <span class="keyword">const</span> map&lt;unsigned short, Rule&gt; &amp;<a class="code" href="classgenevalmag_1_1Attr__grammar.html#a41be9d108df7f8159bd989a5c174be87">Attr_grammar::get_rules</a>()<span class="keyword"> const</span>
<a name="l00281"></a>00281 <span class="keyword"></span>{
<a name="l00282"></a>00282     <span class="keywordflow">return</span> <a class="code" href="classgenevalmag_1_1Attr__grammar.html#a962f40d15bf80b0e10b27126bd149a93">ag_rule</a>;
<a name="l00283"></a>00283 }
<a name="l00284"></a>00284 
<a name="l00288"></a><a class="code" href="classgenevalmag_1_1Attr__grammar.html#a3452d5ee579a9985a52edcf6a97678d5">00288</a> <span class="keyword">const</span> <a class="code" href="classgenevalmag_1_1Rule.html">Rule</a> &amp;<a class="code" href="classgenevalmag_1_1Attr__grammar.html#a3452d5ee579a9985a52edcf6a97678d5">Attr_grammar::get_rule</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> index)<span class="keyword"> const</span>
<a name="l00289"></a>00289 <span class="keyword"></span>{
<a name="l00290"></a>00290     <span class="keywordflow">return</span> <a class="code" href="classgenevalmag_1_1Attr__grammar.html#a962f40d15bf80b0e10b27126bd149a93">ag_rule</a>.find(index)-&gt;second;
<a name="l00291"></a>00291 }
<a name="l00292"></a>00292 
<a name="l00296"></a><a class="code" href="classgenevalmag_1_1Attr__grammar.html#a50a326649bbf48d2d715144cef59a75e">00296</a> <span class="keyword">const</span> map&lt;string, Symbol&gt; &amp;<a class="code" href="classgenevalmag_1_1Attr__grammar.html#a50a326649bbf48d2d715144cef59a75e">Attr_grammar::get_non_terminal_symbols</a>()<span class="keyword"> const</span>
<a name="l00297"></a>00297 <span class="keyword"></span>{
<a name="l00298"></a>00298     <span class="keywordflow">return</span> <a class="code" href="classgenevalmag_1_1Attr__grammar.html#a82631f05839109d0569a1554a35fa906">ag_symb_non_terminals</a>;
<a name="l00299"></a>00299 }
<a name="l00300"></a>00300 
<a name="l00304"></a><a class="code" href="classgenevalmag_1_1Attr__grammar.html#a5a476aa583e3f9e1bbfe182b5ee2f759">00304</a> <span class="keyword">const</span> <a class="code" href="classgenevalmag_1_1Symbol.html">Symbol</a> *<a class="code" href="classgenevalmag_1_1Attr__grammar.html#a5a476aa583e3f9e1bbfe182b5ee2f759">Attr_grammar::get_initial_symb</a>()<span class="keyword"> const</span>
<a name="l00305"></a>00305 <span class="keyword"></span>{
<a name="l00306"></a>00306     <span class="keywordflow">return</span> <a class="code" href="classgenevalmag_1_1Attr__grammar.html#abdcc6aa17756d47b0e6e131b26050b42" title="Saves the name of the initial symbol of the grammar&amp;#39;s attribute.">ag_initial_symb</a>;
<a name="l00307"></a>00307 }
<a name="l00308"></a>00308 
<a name="l00312"></a><a class="code" href="classgenevalmag_1_1Attr__grammar.html#a0f88798aa739681bf39c2620b1f39069">00312</a> <span class="keyword">const</span> vector&lt;unsigned short&gt; <a class="code" href="classgenevalmag_1_1Attr__grammar.html#a0f88798aa739681bf39c2620b1f39069">Attr_grammar::get_rules_with_left_symbol</a>(<span class="keyword">const</span> <a class="code" href="classgenevalmag_1_1Symbol.html">Symbol</a> *symb)<span class="keyword"> const</span>
<a name="l00313"></a>00313 <span class="keyword"></span>{
<a name="l00314"></a>00314     vector&lt;unsigned short&gt; result;
<a name="l00315"></a>00315 
<a name="l00316"></a>00316     <span class="keywordflow">for</span>(map&lt;unsigned short, Rule&gt;::const_iterator it(<a class="code" href="classgenevalmag_1_1Attr__grammar.html#a962f40d15bf80b0e10b27126bd149a93">ag_rule</a>.begin()); it != <a class="code" href="classgenevalmag_1_1Attr__grammar.html#a962f40d15bf80b0e10b27126bd149a93">ag_rule</a>.end(); it++)
<a name="l00317"></a>00317     {
<a name="l00318"></a>00318         <span class="keywordflow">if</span>(it-&gt;second.get_left_symbol()-&gt;equals(*symb))
<a name="l00319"></a>00319         {
<a name="l00320"></a>00320             result.push_back(it-&gt;second.key());
<a name="l00321"></a>00321         }
<a name="l00322"></a>00322     }
<a name="l00323"></a>00323     <span class="keywordflow">return</span> result;
<a name="l00324"></a>00324 }
<a name="l00325"></a>00325 
<a name="l00329"></a><a class="code" href="classgenevalmag_1_1Attr__grammar.html#a47242caf1e804a8fc50e0ab75ea39570">00329</a> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="classgenevalmag_1_1Attr__grammar.html#a47242caf1e804a8fc50e0ab75ea39570">Attr_grammar::get_index_eq_with_context</a>(<span class="keyword">const</span> <a class="code" href="classgenevalmag_1_1Expr__instance.html">Expr_instance</a> *ins, <span class="keyword">const</span> vector&lt;unsigned short&gt; &amp;context_rule)<span class="keyword"> const</span>
<a name="l00330"></a>00330 <span class="keyword"></span>{
<a name="l00331"></a>00331     <span class="keywordtype">short</span> index_ins(ins-&gt;<a class="code" href="classgenevalmag_1_1Expr__instance.html#a5b5bc716afa9f85418c7f58ed0ac0c01">get_num</a>());
<a name="l00332"></a>00332 
<a name="l00333"></a>00333         <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i(0); i &lt; context_rule.size(); i++)
<a name="l00334"></a>00334     {
<a name="l00335"></a>00335         <span class="keyword">const</span> <a class="code" href="classgenevalmag_1_1Rule.html">Rule</a> &amp;rule(<a class="code" href="classgenevalmag_1_1Attr__grammar.html#a962f40d15bf80b0e10b27126bd149a93">ag_rule</a>.find(context_rule[i])-&gt;second);
<a name="l00336"></a>00336 
<a name="l00337"></a>00337         <span class="keywordflow">for</span>(map&lt;unsigned short,Equation&gt;::const_iterator it(rule.get_eqs().begin()); it != rule.get_eqs().end(); it++)
<a name="l00338"></a>00338         {
<a name="l00339"></a>00339             <span class="keywordflow">if</span> (ins-&gt;<a class="code" href="classgenevalmag_1_1Expr__instance.html#a18d92b87a30dbf2ca3833e075f76d52e">get_attr</a>()-&gt;<a class="code" href="classgenevalmag_1_1Attribute.html#aadba4924920a427077f71234c9beb3b5">is_synthetize</a>())
<a name="l00340"></a>00340             {
<a name="l00341"></a>00341                 <span class="comment">/* Only interesting compare symbol and attribute because left_symbol always has index 0. */</span>
<a name="l00342"></a>00342                                 <span class="keywordflow">if</span> (it-&gt;second.get_l_value()-&gt;equals_without_index(ins))
<a name="l00343"></a>00343                                 {
<a name="l00344"></a>00344                                         <span class="keywordflow">if</span> (index_ins == 0)
<a name="l00345"></a>00345                                         {
<a name="l00346"></a>00346                                                 <span class="keywordflow">return</span> it-&gt;first;
<a name="l00347"></a>00347                                         }
<a name="l00348"></a>00348                                         index_ins--;
<a name="l00349"></a>00349                                 }
<a name="l00350"></a>00350             }
<a name="l00351"></a>00351             <span class="keywordflow">else</span>
<a name="l00352"></a>00352             {
<a name="l00353"></a>00353                 <span class="comment">/* The instance has a attrubute inherit, so must be compare with all information instance.  */</span>
<a name="l00354"></a>00354                 <span class="keywordflow">if</span> (it-&gt;second.get_l_value()-&gt;equals(ins))
<a name="l00355"></a>00355                                 {
<a name="l00356"></a>00356                                         <span class="keywordflow">return</span> it-&gt;first;
<a name="l00357"></a>00357                                 }
<a name="l00358"></a>00358             }
<a name="l00359"></a>00359         }
<a name="l00360"></a>00360     }
<a name="l00361"></a>00361     <span class="keywordflow">return</span> 0;
<a name="l00362"></a>00362 }
<a name="l00363"></a>00363 
<a name="l00367"></a><a class="code" href="classgenevalmag_1_1Attr__grammar.html#a8a1e41dee53587c04675a3a46df941af">00367</a> <span class="keyword">const</span> <a class="code" href="classgenevalmag_1_1Equation.html">Equation</a> *<a class="code" href="classgenevalmag_1_1Attr__grammar.html#a8a1e41dee53587c04675a3a46df941af">Attr_grammar::get_eq</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> index)<span class="keyword"> const</span>
<a name="l00368"></a>00368 <span class="keyword"></span>{
<a name="l00369"></a>00369     assert(index &gt;= 1);
<a name="l00370"></a>00370     assert(index &lt;= <a class="code" href="classgenevalmag_1_1Attr__grammar.html#a127f4869156cd76ee3381b19d8c7cc9a" title="Store the count of equations in the gramamar.">count_eqs</a>);
<a name="l00371"></a>00371     <span class="comment">/* The index is valid. */</span>
<a name="l00372"></a>00372 
<a name="l00373"></a>00373     <span class="keywordflow">for</span>(map&lt;unsigned short,Rule&gt;::const_reverse_iterator it_r(<a class="code" href="classgenevalmag_1_1Attr__grammar.html#a962f40d15bf80b0e10b27126bd149a93">ag_rule</a>.rbegin()); it_r != <a class="code" href="classgenevalmag_1_1Attr__grammar.html#a962f40d15bf80b0e10b27126bd149a93">ag_rule</a>.rend(); it_r++)
<a name="l00374"></a>00374     {
<a name="l00375"></a>00375         <span class="keywordflow">if</span>(it_r-&gt;second.get_offset() &lt;= index)
<a name="l00376"></a>00376         <span class="comment">/* The equation must belong to this rule. */</span>
<a name="l00377"></a>00377         {
<a name="l00378"></a>00378             <span class="keywordflow">return</span> it_r-&gt;second.get_eq(index);
<a name="l00379"></a>00379         }
<a name="l00380"></a>00380     }
<a name="l00381"></a>00381     <span class="keywordflow">return</span> NULL;
<a name="l00382"></a>00382 }
<a name="l00383"></a>00383 
<a name="l00387"></a><a class="code" href="classgenevalmag_1_1Attr__grammar.html#a9d743d32f7ecb1f31284d04db9e3051e">00387</a> <span class="keyword">const</span> <a class="code" href="classgenevalmag_1_1Expr__instance.html">Expr_instance</a> *<a class="code" href="classgenevalmag_1_1Attr__grammar.html#a9d743d32f7ecb1f31284d04db9e3051e">Attr_grammar::get_eq_l_value</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> index)<span class="keyword"> const</span>
<a name="l00388"></a>00388 <span class="keyword"></span>{
<a name="l00389"></a>00389     <span class="keyword">const</span> <a class="code" href="classgenevalmag_1_1Equation.html">Equation</a> *eq(<a class="code" href="classgenevalmag_1_1Attr__grammar.html#a8a1e41dee53587c04675a3a46df941af">get_eq</a>(index));
<a name="l00390"></a>00390     assert(eq != NULL);
<a name="l00391"></a>00391     <span class="keywordflow">return</span> eq-&gt;<a class="code" href="classgenevalmag_1_1Equation.html#a357a3dbd9331f2c7acb70fce221b3d2a">get_l_value</a>();
<a name="l00392"></a>00392 }
<a name="l00393"></a>00393 
<a name="l00397"></a><a class="code" href="classgenevalmag_1_1Attr__grammar.html#ad94a52850c818a1f74fc81af99b0d52d">00397</a> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="classgenevalmag_1_1Attr__grammar.html#ad94a52850c818a1f74fc81af99b0d52d">Attr_grammar::get_count_eqs</a>()<span class="keyword"> const</span>
<a name="l00398"></a>00398 <span class="keyword"></span>{
<a name="l00399"></a>00399     <span class="keywordflow">return</span> <a class="code" href="classgenevalmag_1_1Attr__grammar.html#a127f4869156cd76ee3381b19d8c7cc9a" title="Store the count of equations in the gramamar.">count_eqs</a>;
<a name="l00400"></a>00400 }
<a name="l00401"></a>00401 
<a name="l00407"></a><a class="code" href="classgenevalmag_1_1Attr__grammar.html#ad2f2da693afe958a6dc84078c391100e">00407</a> <span class="keyword">const</span> <span class="keywordtype">string</span> <a class="code" href="classgenevalmag_1_1Attr__grammar.html#ad2f2da693afe958a6dc84078c391100e">Attr_grammar::to_string</a>()<span class="keyword"> const</span>
<a name="l00408"></a>00408 <span class="keyword"></span>{
<a name="l00409"></a>00409     <span class="keywordtype">string</span> semdomain(<span class="stringliteral">&quot;semantic domain\n&quot;</span>);
<a name="l00410"></a>00410     semdomain.append(to_string_map&lt;string, Sort&gt;(<a class="code" href="classgenevalmag_1_1Attr__grammar.html#a799dddeffb394e06770b8143b46cbc87">ag_sort</a>));
<a name="l00411"></a>00411     semdomain.append(<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00412"></a>00412     semdomain.append(to_string_map&lt;string, Function&gt;(<a class="code" href="classgenevalmag_1_1Attr__grammar.html#a3ebc66b5f02a2c6806a6002dd09fc34f">ag_func</a>));
<a name="l00413"></a>00413     semdomain.append(<span class="stringliteral">&quot;\nattributes\n&quot;</span>);
<a name="l00414"></a>00414     semdomain.append(to_string_map&lt;string, Attribute&gt;(<a class="code" href="classgenevalmag_1_1Attr__grammar.html#af8eda41983da416b71568b230495cac3">ag_attr</a>));
<a name="l00415"></a>00415     semdomain.append(<span class="stringliteral">&quot;\n/*&quot;</span>);
<a name="l00416"></a>00416     semdomain.append(<span class="stringliteral">&quot;\nsymbols\n&quot;</span>);
<a name="l00417"></a>00417     semdomain.append(to_string_map&lt;string, Symbol&gt;(<a class="code" href="classgenevalmag_1_1Attr__grammar.html#a82631f05839109d0569a1554a35fa906">ag_symb_non_terminals</a>));
<a name="l00418"></a>00418     semdomain.append(to_string_map&lt;string, Symbol&gt;(<a class="code" href="classgenevalmag_1_1Attr__grammar.html#aae56008f83f809143d7f157a7281831d">ag_symb_terminals</a>));
<a name="l00419"></a>00419     semdomain.append(<span class="stringliteral">&quot;*/\n&quot;</span>);
<a name="l00420"></a>00420     semdomain.append(<span class="stringliteral">&quot;/* &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Initial Symbol of Grammar is &quot;</span>);
<a name="l00421"></a>00421     semdomain.append(<a class="code" href="classgenevalmag_1_1Attr__grammar.html#abdcc6aa17756d47b0e6e131b26050b42" title="Saves the name of the initial symbol of the grammar&amp;#39;s attribute.">ag_initial_symb</a>-&gt;<a class="code" href="classgenevalmag_1_1Symbol.html#afcd9c46fe546ec9f1b62caeb99377917">get_name</a>());
<a name="l00422"></a>00422     semdomain.append(<span class="stringliteral">&quot; &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; */\n&quot;</span>);
<a name="l00423"></a>00423     semdomain.append(<span class="stringliteral">&quot;\nrules\n&quot;</span>);
<a name="l00424"></a>00424     semdomain.append(to_string_map&lt;unsigned short, Rule&gt;(<a class="code" href="classgenevalmag_1_1Attr__grammar.html#a962f40d15bf80b0e10b27126bd149a93">ag_rule</a>));
<a name="l00425"></a>00425     semdomain.append(<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00426"></a>00426     <span class="keywordflow">return</span> semdomain;
<a name="l00427"></a>00427 }
<a name="l00428"></a>00428 
<a name="l00429"></a>00429 } <span class="comment">/* end genevalmag */</span>
</pre></div></div>
<hr class="footer"/><address style="text-align: right;"><small>Generated on Sat Sep 4 15:19:11 2010 for maggen by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
